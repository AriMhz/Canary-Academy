{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Azn/Downloads/canary-academy-website/app/api/admissions/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\nconst dataFilePath = path.join(process.cwd(), 'data', 'admissions.json');\r\n\r\n// Helper to read data\r\nfunction getAdmissions() {\r\n    if (!fs.existsSync(dataFilePath)) {\r\n        return [];\r\n    }\r\n    const fileContent = fs.readFileSync(dataFilePath, 'utf-8');\r\n    try {\r\n        return JSON.parse(fileContent);\r\n    } catch (e) {\r\n        return [];\r\n    }\r\n}\r\n\r\n// Helper to write data\r\nfunction saveAdmission(admission: any) {\r\n    const admissions = getAdmissions();\r\n    const newAdmission = {\r\n        ...admission,\r\n        id: Date.now(), // simple ID generation\r\n        submittedAt: new Date().toISOString(),\r\n        status: 'pending'\r\n    };\r\n    admissions.push(newAdmission);\r\n    fs.writeFileSync(dataFilePath, JSON.stringify(admissions, null, 2));\r\n    return newAdmission;\r\n}\r\n\r\nexport async function GET() {\r\n    const admissions = getAdmissions();\r\n    return NextResponse.json(admissions);\r\n}\r\n\r\n// Helper to update admission status\r\nfunction updateAdmissionStatus(id: number | string, status: string) {\r\n    const admissions = getAdmissions();\r\n    const index = admissions.findIndex((a: any) => a.id.toString() === id.toString());\r\n\r\n    if (index !== -1) {\r\n        admissions[index].status = status;\r\n        fs.writeFileSync(dataFilePath, JSON.stringify(admissions, null, 2));\r\n        return admissions[index];\r\n    }\r\n    return null;\r\n}\r\n\r\nexport async function PATCH(request: Request) {\r\n    try {\r\n        const { id, status } = await request.json();\r\n        if (!id || !status) {\r\n            return NextResponse.json({ success: false, error: 'Missing id or status' }, { status: 400 });\r\n        }\r\n\r\n        const updatedAdmission = updateAdmissionStatus(id, status);\r\n\r\n        if (updatedAdmission) {\r\n            return NextResponse.json({ success: true, data: updatedAdmission });\r\n        } else {\r\n            return NextResponse.json({ success: false, error: 'Admission not found' }, { status: 404 });\r\n        }\r\n    } catch (error) {\r\n        return NextResponse.json({ success: false, error: 'Failed to update admission' }, { status: 500 });\r\n    }\r\n}\r\n\r\n// Helper to delete admission\r\nfunction deleteAdmission(id: number | string) {\r\n    const admissions = getAdmissions();\r\n    const index = admissions.findIndex((a: any) => a.id.toString() === id.toString());\r\n\r\n    if (index !== -1) {\r\n        admissions.splice(index, 1);\r\n        fs.writeFileSync(dataFilePath, JSON.stringify(admissions, null, 2));\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nexport async function DELETE(request: Request) {\r\n    try {\r\n        const { searchParams } = new URL(request.url);\r\n        const id = searchParams.get('id');\r\n\r\n        if (!id) {\r\n            return NextResponse.json({ success: false, error: 'Missing id param' }, { status: 400 });\r\n        }\r\n\r\n        const success = deleteAdmission(id);\r\n\r\n        if (success) {\r\n            return NextResponse.json({ success: true });\r\n        } else {\r\n            return NextResponse.json({ success: false, error: 'Admission not found' }, { status: 404 });\r\n        }\r\n    } catch (error) {\r\n        return NextResponse.json({ success: false, error: 'Failed to delete admission' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const data = await request.json();\r\n        const savedAdmission = saveAdmission(data);\r\n        return NextResponse.json({ success: true, data: savedAdmission });\r\n    } catch (error) {\r\n        return NextResponse.json({ success: false, error: 'Failed to save admission' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":"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"}}]
}